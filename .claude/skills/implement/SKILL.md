---
name: implement
description: タスクファイルに基づいてCodex CLIで実装を実行する。
argument-hint: "[CHG番号またはタスクファイルパス]"
disable-model-invocation: true
---

# Codex によるタスク実装

引数: $ARGUMENTS

## 設計原則

Codex の実行自体はユーザーのターミナルで行い、Claude はコマンド生成と結果検証に専念する。これにより Codex の中間出力がコンテキストに一切入らず、ユーザーは進捗をリアルタイムに確認できる。

## 手順

### 1. タスクファイルの特定

引数がファイルパスならそのまま使用する。
CHG番号の場合は `docs/03_tasks/` から Glob で一致するファイルを検索する。
見つからない場合はユーザーに報告して終了する。

### 2. Codex 実行コマンドの生成

タスクファイル名を埋め込んだ実行コマンドを組み立て、ユーザーに提示する:

```
以下のコマンドをターミナルで実行してください:

codex exec --full-auto --cd /Users/george/workspace/ai-ec-experiment \
  "docs/03_tasks/<タスクファイル名> を読み、記載されたタスクをすべて実装してください。AGENTS.md のルールに従うこと。確認や質問は不要です。自主的に実装してください。"
```

コマンドは実行せず、表示のみ行う。ユーザーが自分のターミナルで実行し、進捗をリアルタイムで確認する。

### 3. 完了報告の待機

ユーザーから Codex の完了報告を受けたら、次のステップに進む。

### 4. 結果の検証（最小限のコンテキストで）

**4-a. 変更サマリの確認**（ファイル一覧と変更量のみ）:
```bash
git diff --stat
```

**4-b. ビルド検証**（終了コードで成否判定）:
タスクファイル冒頭の検証コマンドを実行する。

**4-c. 問題がある場合のみ**、差分の該当箇所を確認する。

### 5. ユーザーへの報告

以下を報告する:
- `git diff --stat` の出力（変更ファイル一覧と行数）
- ビルド検証の結果（PASS / FAIL）
- 問題があった場合はその内容と対処案
