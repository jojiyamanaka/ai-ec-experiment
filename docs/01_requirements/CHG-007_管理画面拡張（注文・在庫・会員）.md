# CHG-007: 管理画面拡張（注文・在庫・会員）

作成日: 2026-02-13
ステータス: 起票済み
優先度: 中（M-2）
起源: 管理業務の運用拡張要望

---

## 1. 背景

現行の管理画面は商品管理を中心に構成されており、管理者が日常運用で必要とする「注文」「在庫」「会員」の管理導線が分散している。

このため、以下の課題がある:

- 管理画面内の移動経路が統一されておらず、目的の業務に到達しづらい
- 注文対応、在庫調整、会員対応を横断して実施しにくい
- 運用担当者ごとに必要機能が異なるが、画面構造が拡張前提になっていない

---

## 2. 要件

### 2-1. 左サイドバーによる管理メニュー統一

管理画面の左側にサイドバーを配置し、以下メニューを常時表示する。

- 商品
- 注文
- 在庫
- 会員

各メニュー選択時に、対応する管理画面へ遷移できること。

### 2-2. 商品管理（既存）の維持と統合

既存の商品管理機能（価格・在庫数・公開状態の更新）は維持し、サイドバー経由でも同等に操作できること。

### 2-3. 注文管理の基本機能

注文管理画面で、少なくとも以下を実施できること。

- 注文一覧表示（注文番号、日時、ステータス、金額、会員情報）
- ステータス絞り込み（PENDING / CONFIRMED / SHIPPED / DELIVERED / CANCELLED）
- 注文詳細表示
- ステータス更新（確認、発送、配達完了、キャンセル）

### 2-4. 在庫管理の基本機能

在庫管理画面で、少なくとも以下を実施できること。

- 商品別の在庫一覧表示
- 在庫数の手動調整（増減）
- 在庫不足商品の抽出（しきい値は設定可能）
- 在庫調整履歴の確認（調整前後、理由、実施者、時刻）

### 2-5. 会員管理の基本機能

会員管理画面で、少なくとも以下を実施できること。

- 会員一覧表示（会員ID、氏名/表示名、メール、ロール、登録日、状態）
- 会員詳細表示（基本情報、注文履歴サマリ）
- 会員状態の変更（有効/無効）
- ロール変更（CUSTOMER / ADMIN）

### 2-6. 認可・監査ログ

管理画面のすべての操作は ADMIN ロールのみ許可し、主要更新操作（注文ステータス変更、在庫調整、会員状態/ロール変更）は監査ログに記録すること。

---

## 3. 受け入れ条件

- [ ] 管理画面左側にサイドバーがあり、`商品 / 注文 / 在庫 / 会員` の4メニューが表示される
- [ ] 各メニューを選択すると対応画面に遷移できる
- [ ] 商品管理の既存機能が回帰せず利用できる
- [ ] 注文管理で一覧・詳細・ステータス更新が可能
- [ ] 在庫管理で一覧・調整・不足抽出・履歴確認が可能
- [ ] 会員管理で一覧・詳細・状態変更・ロール変更が可能
- [ ] ADMIN 以外は管理機能にアクセスできない
- [ ] 主要更新操作が監査ログに記録される

---

## 4. 対象外

- BI ダッシュボード（売上分析、LTV 分析など）
- CSV 一括取込/一括出力
- メール配信、クーポン配布、ポイント管理
- 高度な権限分離（部署別・機能別の細粒度RBAC）

---

## 5. 仕様への反映

本要件の実装にあたり、以下ドキュメントの更新を想定する:

- `docs/ui/admin-ui.md` — サイドバー構成と画面仕様の追記
- `docs/ui/api-spec.md` — 在庫管理・会員管理 API の整理/追記
- `docs/specs/inventory.md` — 在庫調整と履歴仕様の明確化
- `docs/specs/authentication.md` — 管理権限と監査要件の追記

