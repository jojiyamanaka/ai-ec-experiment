# 顧客向け画面のUI仕様

**目的**: AIを活用したECサイトの顧客向け画面のUI/UX仕様を定義する

**関連ドキュメント**:
- [技術仕様](../SPEC.md) - 技術方針・アーキテクチャ
- [業務要件](../requirements.md) - ビジネスルール
- [Customer BFF OpenAPI仕様](../api/customer-bff-openapi.json) - 顧客向けAPIエンドポイント
- [デザインシステム](../design-system.md) - UI設計方針・コンポーネント規約

---

## 画面一覧

| 画面名 | パス | 目的 |
|-------|------|------|
| TOP画面 | `/` | サイトのトップページ、おすすめ商品の表示 |
| 商品一覧画面 | `/item` | 全商品の一覧表示 |
| 商品詳細画面 | `/item/:id` | 個別商品の詳細情報表示とカート追加 |
| カート画面 | `/order/cart` | カート内容の確認と編集 |
| 注文確認画面 | `/order/reg` | 注文内容の最終確認 |
| 注文完了画面 | `/order/complete` | 注文完了の通知 |
| 注文詳細画面 | `/order/:id` | 注文の詳細情報表示 |
| 注文履歴画面 | `/order/history` | 会員の過去の注文一覧 |
| マイページ | `/mypage` | 会員情報の更新・住所管理 |
| ログイン画面 | `/auth/login` | 会員ログイン |
| 会員登録画面 | `/auth/register` | 新規会員登録 |

---

## 画面詳細

### 1. TOP画面（/）

**主要要素**: ヘッダー（サイト名+カートアイコン）、バナー（キャッチコピー）、おすすめ商品セクション（3件カード形式）、フッター

**機能**:
- おすすめ商品をカード形式で表示（画像・商品名・価格・在庫バッジ）
- 商品カードクリック → `/item/:id`、「すべて見る」→ `/item`
- カートアイコンに数量バッジ表示、クリック → `/order/cart`
- おすすめ商品の選定: Phase 1は最初の3件（Phase 2以降でAIレコメンデーション予定）

---

### 2. 商品一覧画面（/item）

**機能**:
- 公開表示可能な商品のみ表示（`product.isPublished && category.isPublished && now ∈ [publishStartAt, publishEndAt]`）
- 各カードに: 画像、商品名、価格（¥表示・3桁区切り）、説明、在庫バッジ
- クリック → `/item/:id`
- ページネーション: 1ページ12件、`?page=N` でURL連動、1ページに収まる場合は非表示

**レイアウト**: レスポンシブグリッド — PC: 3列、タブレット: 2列、モバイル: 1列

---

### 3. 商品詳細画面（/item/:id）

**機能**:
- 商品の詳細情報を表示（画像大・商品名・価格・在庫バッジ・説明）
- 「カートに追加」ボタン: 在庫ありかつ購入可能期間内 → カートに追加して `/order/cart` へ遷移、売り切れ/販売期間外 → APIで拒否
- 非表示条件（商品非公開・カテゴリ非公開・公開期間外）に該当する商品は 404 エラー表示

---

### 4. カート画面（/order/cart）

**機能**:
- カート内商品一覧: 画像小・商品名・説明・単価・数量（編集可能）・小計
- 数量変更: `-`/`+`ボタン（最小1、最大9）、直接入力可、0にすると自動削除
- 商品削除: ゴミ箱アイコンで即座に削除
- カート取得時に購入不可商品（商品/カテゴリ非公開、公開期間外、販売期間外）は自動除外
- 合計金額リアルタイム計算
- 注文サマリー: 小計、配送料(¥0)、合計
- 「レジに進む」→ `/order/reg`、「買い物を続ける」→ `/item`
- カート空の場合: 「カートは空です」メッセージ、商品一覧へのリンク表示

---

### 5. 注文確認画面（/order/reg）

**機能**:
- カート内容を確認用に表示（数量変更不可）
- お支払い金額: 小計、配送料(¥0)、手数料(¥0)、合計
- 「注文を確定する」→ 注文作成（在庫引当）→ カートクリア → `/order/complete`
- 「カートに戻る」→ `/order/cart`
- カート空の場合: エラーメッセージ、商品一覧へのリンク

---

### 6. 注文完了画面（/order/complete）

**機能**:
- 注文完了メッセージ、注文番号強調表示、注文内容サマリー（商品一覧+合計金額）
- 「TOPに戻る」→ `/`、「買い物を続ける」→ `/item`
- 直接URLアクセス時: エラーメッセージ（React Router の `state` がnull）

---

### 7. 注文詳細画面（/order/:id）

**機能**:
- 注文情報: 注文番号・注文日時・注文状態バッジ
- 注文状態バッジ色: PENDING(黄)、CONFIRMED(青)、SHIPPED(緑)、DELIVERED(緑)、CANCELLED(グレー)
- 「注文をキャンセル」ボタン: PENDING/CONFIRMED のみ表示、確認ダイアログ付き
- 注文商品一覧、お支払い金額

---

### 8. ログイン画面（/auth/login）

- メールアドレス・パスワードで認証
- 成功時: トークンを `localStorage` に保存、TOPへ遷移
- 失敗時: 「メールアドレスまたはパスワードが正しくありません」表示
- 「会員登録はこちら」→ `/auth/register`

### 9. 会員登録画面（/auth/register）

- メールアドレス・表示名・パスワードで登録
- 成功時: 自動ログイン、TOPへ遷移
- メール重複時: エラーメッセージ表示
- 「ログインはこちら」→ `/auth/login`

### 10. 注文履歴画面（/order/history）

- 認証必須（未ログイン時はログイン画面へリダイレクト）
- 自分の注文のみ表示、作成日時降順
- 注文番号クリック → `/order/:id`

### 11. マイページ（/mypage）

- 認証必須（未ログイン時はログイン導線を表示）
- プロフィール更新: `displayName`, `fullName`, `phoneNumber`, `birthDate`, `newsletterOptIn`
- 住所管理: 住所の追加・更新・削除、デフォルト住所切替
- 利用API:
  - `GET /api/members/me`
  - `PUT /api/members/me`
  - `POST /api/members/me/addresses`
  - `PUT /api/members/me/addresses/{addressId}`
  - `DELETE /api/members/me/addresses/{addressId}`
- 非許可項目（`memberRank`, `loyaltyPoints` など）を更新しようとした場合はエラー表示

---

## 画面遷移図

### 顧客向け画面遷移

```
[TOP /] ──→ 商品カード → [商品詳細 /item/:id] ──→ カートに追加 → [カート /order/cart]
  │                                                                      │
  ├──→ すべて見る → [商品一覧 /item] ──→ 商品カード → [商品詳細]          │
  │                                                                      │
  └──→ カートアイコン → [カート /order/cart] ←────────────────────────────┘
                              │
                        レジに進む
                              ▼
                     [注文確認 /order/reg]
                              │
                        注文を確定する
                              ▼
                     [注文完了 /order/complete] ──→ [注文詳細 /order/:id]
                         │         │                      │
                    TOPに戻る  買い物を続ける          キャンセル
                         ▼         ▼
                      [TOP]    [商品一覧]

--- 認証・会員 ---
[ログイン /auth/login] ←→ [会員登録 /auth/register]
         │                           │
    ログイン成功                  登録成功
         └──────────┬────────────────┘
                    ▼
               [TOP /]

[注文履歴 /order/history] → 注文クリック → [注文詳細 /order/:id]
```

### 管理画面遷移

```
フッター「管理画面」→ [商品管理 /bo/item] ←→ [注文管理 /bo/order] → 注文クリック → [注文詳細 /order/:id]
```

---

## UI/UX設計思想

デザインの詳細は [デザインシステム仕様書](../design-system.md) を参照。

**デザインコンセプト**: モノトーン＋ニュアンスカラーによるエディトリアルデザイン。高級感と洗練性を重視。

**レスポンシブデザイン**:
- モバイル: デフォルト（< 640px）→ 1カラム
- タブレット: `sm:` (≥ 640px) → 2カラム
- PC: `md:` (≥ 768px) / `lg:` (≥ 1024px) → 3カラム

**インタラクションパターン**:
- ローディング: スピナー表示
- エラー: フォーム入力下に赤文字 / API エラーはトースト
- 成功: 緑色トースト / カートアイコンバッジ数増加
