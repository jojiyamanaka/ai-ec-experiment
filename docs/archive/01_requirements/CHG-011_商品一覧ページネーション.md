# CHG-011: 商品一覧のページネーション機能

作成日: 2026-02-17
ステータス: 起票済み
優先度: 低（L-1）
起源: `docs/spec-implementation-gaps.md` L-1

---

## 1. 背景

商品一覧API（`GET /api/item`）は `page` / `limit` パラメータによるページングをサポートしているが、フロントエンドの商品一覧画面（`/item`）ではページネーション機能が未実装である。

現在の実装では `getItems()` をデフォルト引数（page=1, limit=20）で呼び出し、取得した商品を単一ページに表示している。APIレスポンスに含まれるページネーションメタデータ（`total`, `page`, `limit`）も破棄されている。

商品数が20件以下の現段階では問題ないが、商品数が増加した場合に以下の問題が発生する:

- 21件目以降の商品がユーザーに表示されない
- 全件取得に変更した場合、商品数増加時にパフォーマンスが劣化する
- ユーザーが商品を探しやすく閲覧するためのナビゲーションがない

**参照**:
- `docs/spec-implementation-gaps.md` L-1

---

## 2. 要件

### 2-1. 商品一覧画面にページネーションUIを追加する

商品一覧画面（`/item`）にページ切り替えのUIを追加し、ユーザーが全商品を閲覧できるようにする。

- 1ページあたりの表示件数: 12件（3列グリッド × 4行を基本とする）
- ページ切り替え時にAPIを再呼び出しし、該当ページの商品を取得する
- 現在のページ番号と総ページ数をユーザーに表示する

### 2-2. ページネーションメタデータを保持する

APIレスポンスに含まれるページネーション情報（`total`, `page`, `limit`）をフロントエンドで保持・活用する。

- 総商品件数に基づいて総ページ数を算出する
- 先頭ページ・末尾ページでの不要なナビゲーションを無効化する（例: 1ページ目で「前へ」を無効化）

### 2-3. URLとページ状態を連動させる

ページ番号をURLのクエリパラメータ（例: `/item?page=2`）で管理する。

- ブラウザの戻る/進むボタンでページ遷移が正しく動作すること
- 特定ページへの直接アクセス（URLの共有）が可能であること
- ページパラメータが不正な場合（0以下、最大ページ超過、非数値）は1ページ目を表示する

### 2-4. 商品数が1ページに収まる場合はページネーションUIを非表示にする

総商品件数が1ページあたりの表示件数以下の場合、ページネーションUIを表示しない。これにより現状の商品数が少ない段階での見た目に影響を与えない。

---

## 3. 受け入れ条件

- [ ] 商品一覧画面でページ切り替えができる
- [ ] 1ページあたり12件の商品が表示される
- [ ] 現在のページ番号と総ページ数が表示される
- [ ] 先頭/末尾ページで前/次ボタンが無効化される
- [ ] URLのクエリパラメータでページ状態が管理される
- [ ] ブラウザの戻る/進むボタンでページ遷移が正しく動作する
- [ ] 商品数が12件以下の場合、ページネーションUIが非表示になる
- [ ] ページ切り替え時にローディング状態が表示される
- [ ] 既存の画面遷移（商品カードクリック → 詳細画面）に影響がないこと

---

## 4. スコープ外

- バックエンドAPIの変更（既にページングをサポート済み）
- 管理画面の商品一覧へのページネーション追加
- 検索・フィルタリング機能
- 無限スクロール方式の実装

---

## 5. 仕様への反映

本要件の実装にあたり、以下の仕様ドキュメントに追記が必要:

- `docs/ui/customer-ui.md` — 商品一覧画面の仕様にページネーション機能を追記
- `docs/spec-implementation-gaps.md` — L-1のステータスを更新

---

## 6. 関連資料

- `docs/spec-implementation-gaps.md` L-1
- `docs/ui/api-spec.md` — 商品一覧API（`GET /api/item`、`page`/`limit`パラメータ）
- `docs/ui/customer-ui.md` — 商品一覧画面仕様
