# CHG-024: ç®¡ç†ç”»é¢ã®æ¤œç´¢æ©Ÿèƒ½å¼·åŒ– - å®Ÿè£…ã‚¿ã‚¹ã‚¯

è¦ä»¶: `docs/01_requirements/CHG-024_ç®¡ç†ç”»é¢ã®æ¤œç´¢æ©Ÿèƒ½å¼·åŒ–.md`
è¨­è¨ˆ: `docs/02_designs/CHG-024_ç®¡ç†ç”»é¢ã®æ¤œç´¢æ©Ÿèƒ½å¼·åŒ–.md`
ä½œæˆæ—¥: 2026-02-22

---

## ã‚¿ã‚¹ã‚¯ä¸€è¦§

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

- [ ] **T-1** `[CONTRACT]`: å•†å“ä¸€è¦§APIã«è¤‡åˆæ¤œç´¢æ¡ä»¶ï¼ˆkeyword/categoryId/isPublished/inSalePeriod/allocationType/stockThreshold/zeroStockOnlyï¼‰ã‚’è¿½åŠ ã—ã€Specificationã§å‹•çš„ãƒ•ã‚£ãƒ«ã‚¿ã‚’å®Ÿè£…ã™ã‚‹

  è§¦ã‚‹ç¯„å›²: `backend/src/main/java/com/example/aiec/modules/product / application/dto, application/spec, application/usecase, domain/repository, adapter/rest`

  Done: `cd backend && ./mvnw test -Dtest=BoAdminProductControllerContractTest,ProductUseCaseTest` ãŒé€šã‚‹ã“ã¨

  > ğŸ“ ã‚²ãƒ¼ãƒˆé«˜ã€‚Codex ã¯ review-noteï¼ˆã‚¯ã‚¨ãƒªå¥‘ç´„ã€`zeroStockOnly` å„ªå…ˆãƒ«ãƒ¼ãƒ«ã€`effectiveStock` åˆ¤å®šè²¬å‹™ï¼‰ã‚’ `docs/04_review-note/CHG-024.md` ã® `## T-1` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½è¨˜ã—ã€è¿½åŠ æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚Final Gate çµæœã¨ Review Packet ã‚‚åŒãƒ•ã‚¡ã‚¤ãƒ«ã¸è¨˜éŒ²ã™ã‚‹ã“ã¨ã€‚

---

- [ ] **T-2** `[CONTRACT]`: æ³¨æ–‡ä¸€è¦§APIã«è¤‡åˆæ¤œç´¢æ¡ä»¶ã¨ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’å°å…¥ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ `orders + pagination` ã¸çµ±ä¸€ã™ã‚‹

  è§¦ã‚‹ç¯„å›²: `backend/src/main/java/com/example/aiec/modules/purchase / application/dto, application/spec, application/usecase, order/repository, adapter/rest`

  Done: `cd backend && ./mvnw test -Dtest=OrderControllerContractTest,OrderUseCaseTest` ãŒé€šã‚‹ã“ã¨

  > ğŸ“ ã‚²ãƒ¼ãƒˆé«˜ã€‚Codex ã¯ review-noteï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹å¥‘ç´„å¤‰æ›´ã€`allocationIncomplete`/`unshipped` å¢ƒç•Œã€`statuses` ä¸æ­£å€¤æ™‚ã®400å¥‘ç´„ï¼‰ã‚’ `docs/04_review-note/CHG-024.md` ã® `## T-2` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½è¨˜ã—ã€è¿½åŠ æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚Final Gate çµæœã¨ Review Packet ã‚‚åŒãƒ•ã‚¡ã‚¤ãƒ«ã¸è¨˜éŒ²ã™ã‚‹ã“ã¨ã€‚

---

### BFF

- [ ] **T-3** `[CONTRACT]`: BackOffice BFFã®å•†å“ãƒ»æ³¨æ–‡APIã§æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’é€éã—ã€æ³¨æ–‡ä¸€è¦§ã®å…¨ä»¶å–å¾—å‰æã‚’å»ƒæ­¢ã—ã¦Core APIã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å®Ÿå€¤ã‚’è¿”ã™

  è§¦ã‚‹ç¯„å›²: `bff/backoffice-bff/src/products / products.controller.ts, products.service.ts`ã€`bff/backoffice-bff/src/orders / orders.controller.ts, orders.service.ts`

  Done: `cd bff/backoffice-bff && npm run build` ãŒé€šã‚‹ã“ã¨

  > ğŸ“ ã‚²ãƒ¼ãƒˆé«˜ã€‚Codex ã¯ review-noteï¼ˆBFFå…¬é–‹å¥‘ç´„ã®å·®åˆ†ã€Core APIé€éæ–¹é‡ã€æ—¢å­˜ãƒ•ãƒ­ãƒ³ãƒˆäº’æ›ã®æ‰±ã„ï¼‰ã‚’ `docs/04_review-note/CHG-024.md` ã® `## T-3` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½è¨˜ã—ã€è¿½åŠ æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚Final Gate çµæœã¨ Review Packet ã‚‚åŒãƒ•ã‚¡ã‚¤ãƒ«ã¸è¨˜éŒ²ã™ã‚‹ã“ã¨ã€‚

---

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- [ ] **T-4** `[CONTRACT]`: FSDã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ/å‹å®šç¾©ã«ç®¡ç†ç”»é¢æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã€BFFå¥‘ç´„å¤‰æ›´å¾Œã®æ³¨æ–‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ ã‚’åæ˜ ã™ã‚‹

  è§¦ã‚‹ç¯„å›²: `frontend/src/entities/product/model / api.ts, types.ts`ã€`frontend/src/entities/order/model / api.ts, types.ts`

  Done: `npm run build --prefix frontend` ãŒé€šã‚‹ã“ã¨

  > ğŸ“ ã‚²ãƒ¼ãƒˆé«˜ã€‚Codex ã¯ review-noteï¼ˆãƒ•ãƒ­ãƒ³ãƒˆå‹å¥‘ç´„å·®åˆ†ã€ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³é …ç›®ã®äº’æ›æ€§ï¼‰ã‚’ `docs/04_review-note/CHG-024.md` ã® `## T-4` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½è¨˜ã—ã€è¿½åŠ æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚Final Gate çµæœã¨ Review Packet ã‚‚åŒãƒ•ã‚¡ã‚¤ãƒ«ã¸è¨˜éŒ²ã™ã‚‹ã“ã¨ã€‚

---

- [ ] **T-5** `[SAFE]`: å•†å“ç®¡ç†ç”»é¢ã‚’ `useSearchParams` åŒæœŸã¸ç§»è¡Œã—ã€è¤‡åˆãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚¯ãƒªã‚¢æ“ä½œãƒ»ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»0ä»¶è¡¨ç¤ºã‚’å®Ÿè£…ã™ã‚‹

  è§¦ã‚‹ç¯„å›²: `frontend/src/pages/admin/AdminItemPage / index.tsx`

  Done: `npm run build --prefix frontend && cd frontend && bash ./e2e/admin-smoke.sh` ãŒé€šã‚‹ã“ã¨

---

- [ ] **T-6** `[SAFE]`: æ³¨æ–‡ç®¡ç†ç”»é¢ã‚’ `useSearchParams` åŒæœŸã¸ç§»è¡Œã—ã€è¤‡åˆãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚¯ãƒªã‚¢æ“ä½œãƒ»ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»0ä»¶è¡¨ç¤ºã‚’å®Ÿè£…ã™ã‚‹

  è§¦ã‚‹ç¯„å›²: `frontend/src/pages/admin/AdminOrderPage / index.tsx`

  Done: `npm run build --prefix frontend && cd frontend && bash ./e2e/admin-smoke.sh` ãŒé€šã‚‹ã“ã¨

---

- [ ] **T-7** `[SAFE]`: ç®¡ç†ç”»é¢ã®æ¤œç´¢æ¡ä»¶ä¿æŒã‚’E2Eã§ç¢ºèªã—ã€URLç›´ã‚¢ã‚¯ã‚»ã‚¹ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶æˆ»ã‚‹ãƒ»è¤‡æ•°æ¡ä»¶ANDãŒå†ç¾ã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹

  è§¦ã‚‹ç¯„å›²: `frontend/src/pages/admin/AdminItemPage / index.tsx`ã€`frontend/src/pages/admin/AdminOrderPage / index.tsx`

  Done: MCP Playwright ã§ `http://localhost:5174/bo/item` ã¨ `http://localhost:5174/bo/order` ã‚’æ“ä½œã—ã€URLã‚¯ã‚¨ãƒªå¾©å…ƒãƒ»æˆ»ã‚‹æ“ä½œç¶­æŒãƒ»0ä»¶è¡¨ç¤ºã‚’ç¢ºèªã§ãã‚‹ã“ã¨

---

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ ] **T-8** `[CONTRACT]`: ç®¡ç†ç”»é¢æ¤œç´¢æ‹¡å¼µã®ä»•æ§˜ã‚’UIä»•æ§˜æ›¸ãƒ»OpenAPIãƒ»æ¥­å‹™ä»•æ§˜ã¸åæ˜ ã™ã‚‹

  è§¦ã‚‹ç¯„å›²: `docs/ui/admin-ui.md`ã€`docs/api/backoffice-bff-openapi.json`ã€`docs/specs/order.md`ã€`docs/specs/product.md`

  Done: `rg -n "keyword|stockThreshold|zeroStockOnly|allocationIncomplete|unshipped|customerEmail|statuses|dateFrom|dateTo|totalPriceMin|totalPriceMax" docs/ui/admin-ui.md docs/api/backoffice-bff-openapi.json docs/specs/order.md docs/specs/product.md` ã§åæ˜ ç®‡æ‰€ã‚’ç¢ºèªã§ãã‚‹ã“ã¨

  > ğŸ“ ã‚²ãƒ¼ãƒˆé«˜ã€‚Codex ã¯ review-noteï¼ˆä»•æ§˜æ–‡è¨€ã¨APIå¥‘ç´„ã®æ•´åˆï¼‰ã‚’ `docs/04_review-note/CHG-024.md` ã® `## T-8` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½è¨˜ã—ã€è¿½åŠ æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚Final Gate çµæœã¨ Review Packet ã‚‚åŒãƒ•ã‚¡ã‚¤ãƒ«ã¸è¨˜éŒ²ã™ã‚‹ã“ã¨ã€‚

---

## å®Ÿè£…é †åº

```
T-1 â†’ T-2 â†’ T-3 â†’ T-4 â†’ T-5 â†’ T-6 â†’ T-7 â†’ T-8
```

---

## æ¤œè¨¼

### Per-task æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰

```bash
# Backend
cd backend && ./mvnw test -Dtest=BoAdminProductControllerContractTest,ProductUseCaseTest
cd backend && ./mvnw test -Dtest=OrderControllerContractTest,OrderUseCaseTest

# BackOffice BFF
cd bff/backoffice-bff && npm run build

# Frontend
npm run build --prefix frontend
npm run build --prefix frontend && cd frontend && bash ./e2e/admin-smoke.sh

# Docs
rg -n "keyword|stockThreshold|zeroStockOnly|allocationIncomplete|unshipped|customerEmail|statuses|dateFrom|dateTo|totalPriceMin|totalPriceMax" \
  docs/ui/admin-ui.md \
  docs/api/backoffice-bff-openapi.json \
  docs/specs/order.md \
  docs/specs/product.md
```

### Final Gateï¼ˆå…¨ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã«å¿…ãšå®Ÿè¡Œã—ã€çµæœã‚’ `docs/04_review-note/CHG-024.md` ã«è¨˜éŒ²ã™ã‚‹ã“ã¨ï¼‰

```bash
# å¤‰æ›´å¯¾è±¡ã‚³ãƒ³ãƒ†ãƒŠã®å†ãƒ“ãƒ«ãƒ‰ï¼ˆå¿…é ˆï¼‰
docker compose build backend backoffice-bff frontend-admin frontend-customer

# ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
docker compose up -d

# Backend
cd backend && ./mvnw compile
cd backend && ./mvnw test

# BFF
cd bff/backoffice-bff && npm run build

# Frontend
npm run build --prefix frontend
cd frontend && bash ./e2e/admin-smoke.sh

# Health
curl -sS -o /dev/null -w "backoffice-bff=%{http_code}\n" http://localhost:3002/health
curl -sS -o /dev/null -w "frontend-admin=%{http_code}\n" http://localhost:5174
```

**Final Gate è¨˜éŒ²å…ˆ:** `docs/04_review-note/CHG-024.md` ã® `## Final Gate çµæœ`

---

## ãƒ†ã‚¹ãƒˆæ‰‹é †

1. ç®¡ç†å•†å“ä¸€è¦§ã§ `allocationType=REAL` ã¨ `zeroStockOnly=true` ã‚’åŒæ™‚æŒ‡å®šã—ã€æ¡ä»¶ä¸€è‡´å•†å“ã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
2. ç®¡ç†æ³¨æ–‡ä¸€è¦§ã§ `customerEmail`ãƒ»`statuses`ãƒ»`allocationIncomplete=true` ã‚’çµ„ã¿åˆã‚ã›ã€å¯¾è±¡æ³¨æ–‡ã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
3. `dateFrom/dateTo` ã¨ `totalPriceMin/totalPriceMax` ã‚’çµ„ã¿åˆã‚ã›ã€ç¯„å›²å¤–æ³¨æ–‡ãŒé™¤å¤–ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
4. URLã‚¯ã‚¨ãƒªä»˜ãã§ `/bo/item` ã¨ `/bo/order` ã‚’ç›´æ¥é–‹ãã€åŒä¸€æ¡ä»¶ãŒå¾©å…ƒã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
5. æ¤œç´¢å¾Œã«ãƒ–ãƒ©ã‚¦ã‚¶æˆ»ã‚‹ã‚’å®Ÿè¡Œã—ã€ç›´å‰ã®æ¤œç´¢çŠ¶æ…‹ãŒç¶­æŒã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
6. è©²å½“ãªã—æ¡ä»¶ã‚’æŒ‡å®šã—ã€ã€Œè©²å½“ãƒ‡ãƒ¼ã‚¿ãªã—ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
